#! /usr/bin/python

import subprocess
import sys

def main():
  submit_args = sys.argv[1:]
  if '-h' in submit_args or '--help' in submit_args:
    subprocess.check_call(['git5', 'submit'] + submit_args)
    return

  # if len(submit_args) == 1 and not submit_args[0].startswith('-'):
  #   branch_to_submit = submit_args.pop(0)
  #   #submit_args.check_call(['git', 'checkout', branch_to_submit])
  try:
    subprocess.check_call(['git5', 'submit'] + submit_args)
  except subprocess.CalledProcessError:
    sys.exit(1)
  recent_branches = subprocess.check_output(['git-recent-branches']).split('\n')
  subprocess.check_call(['git', 'checkout', recent_branches[0]])
  subprocess.check_call(['git5', 'cleanup', '--no-questions'])

if __name__ == '__main__':
  main()
